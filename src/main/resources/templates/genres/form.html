<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${genre.id == null} ? '–î–æ–±–∞–≤–∏—Ç—å –∂–∞–Ω—Ä' : '–ò–∑–º–µ–Ω–∏—Ç—å –∂–∞–Ω—Ä'">–§–æ—Ä–º–∞ –∂–∞–Ω—Ä–∞</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand" href="/books">üìö –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</a>
        <div class="navbar-nav">
            <a class="nav-link" href="/books">–ö–Ω–∏–≥–∏</a>
            <a class="nav-link" href="/authors">–ê–≤—Ç–æ—Ä—ã</a>
            <a class="nav-link active" href="/genres">–ñ–∞–Ω—Ä—ã</a>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <h1 th:text="${genre.id == null} ? '–î–æ–±–∞–≤–∏—Ç—å –∂–∞–Ω—Ä' : '–ò–∑–º–µ–Ω–∏—Ç—å –∂–∞–Ω—Ä'"></h1>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö -->
    <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
        <strong>–û—à–∏–±–∫–∞!</strong> <span th:text="${error}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∂–∞–Ω—Ä–∞ -->
    <form th:action="${genre.id == null} ? @{/genres} : @{/genres/update/{id}(id=${genre.id})}"
          th:object="${genre}" method="post">

        <div class="mb-3">
            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∂–∞–Ω—Ä–∞ *</label>
            <input type="text" class="form-control" th:field="*{name}"
                   required minlength="1" maxlength="100">
            <div class="form-text">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, –Ω–µ –±–æ–ª–µ–µ 100 —Å–∏–º–≤–æ–ª–æ–≤</div>
            <div class="text-danger" th:if="${#fields.hasErrors('name')}"
                 th:errors="*{name}"></div>
        </div>

        <div class="mb-3">
            <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea class="form-control" th:field="*{description}"
                      rows="4" maxlength="500"></textarea>
            <div class="form-text">–ù–µ –±–æ–ª–µ–µ 500 —Å–∏–º–≤–æ–ª–æ–≤</div>
            <div class="text-danger" th:if="${#fields.hasErrors('description')}"
                 th:errors="*{description}"></div>
        </div>

        <button type="submit" class="btn btn-success">
            <span th:text="${genre.id == null} ? '–î–æ–±–∞–≤–∏—Ç—å –∂–∞–Ω—Ä' : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è'"></span>
        </button>
        <a href="/genres" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
    </form>
</div>

<!-- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form');

        form.addEventListener('submit', function(event) {
            const name = document.querySelector('input[name="name"]').value.trim();

            if (!name) {
                event.preventDefault();
                alert('–ù–∞–∑–≤–∞–Ω–∏–µ –∂–∞–Ω—Ä–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ');
                return false;
            }

            if (name.length > 100) {
                event.preventDefault();
                alert('–ù–∞–∑–≤–∞–Ω–∏–µ –∂–∞–Ω—Ä–∞ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 100 —Å–∏–º–≤–æ–ª–æ–≤');
                return false;
            }
        });
    });
</script>
</body>
</html>